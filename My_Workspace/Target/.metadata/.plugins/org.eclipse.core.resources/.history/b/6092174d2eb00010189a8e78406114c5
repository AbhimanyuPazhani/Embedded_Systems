/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2025 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */

#include <stdint.h>

#include "main.h"
int main(void)
{
	RCC_AHB1ENR_t volatile *const pClkCtrl= (RCC_AHB1ENR_t*) 0x40023830;


	GPIOx_MODE_t volatile *const pGpiobMode = (GPIOx_MODE_t*) 0x40020400;


	GPIOx_ODR_t volatile *const pPortBOutReg= (GPIOx_ODR_t*)0x40020414;


	pClkCtrl-> gpiob_en = 1;

	pGpiobMode->pin_7 = 1;  //*(0x40020400) |= (3<< 30); Compiler will generate the instructions to program the appropriate bit position in the peripheral register address
	//Instead of writing of set and clear value with address we give this process to compiler by simply pGpiobMode->pin_7 = 3; command



	while(1)
	{
			pPortBOutReg->pin_7 = 1;
		     //This loop executes for 10k times
			 for(uint32_t i =0; i<300000;i++);

			 //Trun of the LED but adding not operator at the outreeg
			 pPortBOutReg ->pin_7= 0;

			 for(uint32_t i =0; i<300000;i++);

	}


	/* Loop forever */

}

/*
   we used the above code instead of the below one, the compiler do the set and clear part due to typedef struct
	uint32_t *pClkctrlreg = (uint32_t*)0x40023830;
	uint32_t *pPortBModeReg = (uint32_t*)0x40020400 ;
	uint32_t *pPortBOutReg = (uint32_t*)0x40020414;

	//1. Enable the clock for the GPIOB peripheral in the AHB1ENR
//	uint32_t temp = *pClkctrlreg; //read operation
//	temp = temp | 0x02; //modify
//	*pClkctrlreg = temp; //write back
	*pClkctrlreg |=(1<<1) ;  //page no: 161 for port B

	//2. configure the mode of the IO pin as output  //page no 205 0x ffff3fff
	// a. Clear the 14th and 15th pin position (C:EAR)
	 *pPortBModeReg &= ~(3 << (7 * 2)); // clear bits 15:14
	 *pPortBModeReg |=  (1 << (7 * 2)); // set as output

	//the 15th and 14th bit for the GPIO B for clk setting need to enable that as read and write 14th bit should be 1 for this 00000000000010000000000000000
	while(1)
	{
	//3. Set the 3rd bit of ODR output data register HIGH for blinking an LED
	 *pPortBOutReg |= (1<<7);   // LED ON  -- 0x0080

	 //introducing small observable delay
	 //This loop executes for 10k times
	 for(uint32_t i =0; i<300000;i++);

	 //Trun of the LED but adding not operator at the outreeg
	 *pPortBOutReg &= ~(1<<7);

	 for(uint32_t i =0; i<300000;i++);
 */

